# üîê –ü–æ—Å—ñ–±–Ω–∏–∫ –∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤

## –û–≥–ª—è–¥

–°–∏—Å—Ç–µ–º–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—î –¥–≤–∞ —Å–ø–æ—Å–æ–±–∏ –≤—Ö–æ–¥—É –≤ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω—É –ø–∞–Ω–µ–ª—å:
1. **–õ–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å** - —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–∏–π –≤—Ö—ñ–¥ —á–µ—Ä–µ–∑ email —Ç–∞ –ø–∞—Ä–æ–ª—å
2. **Telegram** - —à–≤–∏–¥–∫–∏–π –≤—Ö—ñ–¥ —á–µ—Ä–µ–∑ Telegram –∞–∫–∞—É–Ω—Ç

---

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

### –ö–æ–ª–µ–∫—Ü—ñ—è `admins`

–ö–æ–∂–µ–Ω –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä/–∞–≥–µ–Ω—Ç –º–∞—î —Ç–∞–∫—ñ –ø–æ–ª—è:

```javascript
{
  _id: ObjectId,
  first_name: String,      // –Ü–º'—è
  last_name: String,       // –ü—Ä—ñ–∑–≤–∏—â–µ
  email: String,           // Email (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ –ª–æ–≥—ñ–Ω)
  phone: String,           // –¢–µ–ª–µ—Ñ–æ–Ω (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
  login: String,           // –õ–æ–≥—ñ–Ω (–∑–∞–∑–≤–∏—á–∞–π = email)
  password: String | null, // –•–µ—à –ø–∞—Ä–æ–ª—è (bcrypt) –∞–±–æ null —è–∫—â–æ —Ç—ñ–ª—å–∫–∏ Telegram
  telegram_id: Number,     // ID Telegram –∞–∫–∞—É–Ω—Ç–∞ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
  role: String,            // "admin" –∞–±–æ "agent"
  is_verified: Boolean,    // –ß–∏ –≤–µ—Ä–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∞–∫–∞—É–Ω—Ç
  language_code: String,   // –ö–æ–¥ –º–æ–≤–∏ (uk, en, ru)
  created_at: Date,
  updated_at: Date
}
```

---

## üîë –í–∞—Ä—ñ–∞–Ω—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –õ–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å

**–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è:**
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π –ø–∞—Ä–æ–ª—å –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö
- –ü–æ–ª–µ `password` –Ω–µ —î `null`

**–Ø–∫ –ø—Ä–∞—Ü—é—î:**
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å email (–ª–æ–≥—ñ–Ω) —Ç–∞ –ø–∞—Ä–æ–ª—å
2. –°–∏—Å—Ç–µ–º–∞ —à—É–∫–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ `login` –≤ –±–∞–∑—ñ
3. –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Ö–µ—à –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ `bcrypt.compare()`
4. –ü—Ä–∏ —É—Å–ø—ñ—Ö—É –ø–æ–≤–µ—Ä—Ç–∞—î —Ç–æ–∫–µ–Ω —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

**–ü—Ä–∏–∫–ª–∞–¥ –∑–∞–ø–∏—Ç—É:**
```javascript
POST /api/admin/auth
{
  "login": "lilkakish@gmail.com",
  "password": "your_password"
}
```

**–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:**
```javascript
{
  "success": true,
  "token": "base64_token",
  "admin": {
    "id": "6875195afbe9256561be9248",
    "first_name": "–°–∞—à–∞",
    "last_name": "–ß–∏–∂–∏–∫–æ–≤",
    "email": "lilkakish@gmail.com",
    "role": "admin",
    "telegram_id": 6738834018
  },
  "message": "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞"
}
```

---

### –í–∞—Ä—ñ–∞–Ω—Ç 2: Telegram

**–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è:**
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î `telegram_id` –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö
- –ú–æ–∂–µ –º–∞—Ç–∏ –∞–±–æ –Ω–µ –º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å

**–Ø–∫ –ø—Ä–∞—Ü—é—î:**
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–∫–∞—î –∫–Ω–æ–ø–∫—É "Telegram"
2. –ó'—è–≤–ª—è—î—Ç—å—Å—è Telegram Login Widget
3. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–æ—Ä–∏–∑—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram
4. Telegram –ø–æ–≤–µ—Ä—Ç–∞—î `user.id`
5. –°–∏—Å—Ç–µ–º–∞ —à—É–∫–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ `telegram_id` –≤ –±–∞–∑—ñ
6. –ü—Ä–∏ —É—Å–ø—ñ—Ö—É –ø–æ–≤–µ—Ä—Ç–∞—î —Ç–æ–∫–µ–Ω —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

**–ü—Ä–∏–∫–ª–∞–¥ –∑–∞–ø–∏—Ç—É:**
```javascript
POST /api/admin/auth
{
  "telegram_id": 1815759898
}
```

**–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:** (—Ç–∞–∫–∏–π —Å–∞–º–∏–π —è–∫ —É –≤–∞—Ä—ñ–∞–Ω—Ç—ñ 1)

---

## üöÄ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Telegram Login Widget

### –ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–æ—Ç–∞

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞: `/newbot`
3. –î–∞–π—Ç–µ –π–æ–º—É —ñ–º'—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "Kovcheg Estate Bot")
4. –û—Ç—Ä–∏–º–∞–π—Ç–µ username (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `kovcheg_estate_bot`)

### –ö—Ä–æ–∫ 2: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ–º–µ–Ω—É

1. –£ BotFather –≤–∏–∫–æ–Ω–∞–π—Ç–µ: `/setdomain`
2. –í–∏–±–µ—Ä—ñ—Ç—å –≤–∞—à–æ–≥–æ –±–æ—Ç–∞
3. –í–∫–∞–∂—ñ—Ç—å –¥–æ–º–µ–Ω: `yourdomain.com` (–±–µ–∑ https://)

### –ö—Ä–æ–∫ 3: –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–¥—É

–£ —Ñ–∞–π–ª—ñ `/pages/admin/index.tsx` –∑–Ω–∞–π–¥—ñ—Ç—å:

```html
<script
  async
  src="https://telegram.org/js/telegram-widget.js?22"
  data-telegram-login="kovcheg_estate_bot"  <!-- –ó–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à bot username -->
  data-size="large"
  data-onauth="onTelegramAuth(user)"
  data-request-access="write"
/>
```

–ó–∞–º—ñ–Ω—ñ—Ç—å `kovcheg_estate_bot` –Ω–∞ username –≤–∞—à–æ–≥–æ –±–æ—Ç–∞.

---

## üë§ –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤

### –ß–µ—Ä–µ–∑ MongoDB Compass –∞–±–æ mongosh

**–ê–¥–º—ñ–Ω –∑ –ø–∞—Ä–æ–ª–µ–º:**

```javascript
db.admins.insertOne({
  first_name: "–Ü–≤–∞–Ω",
  last_name: "–ü–µ—Ç—Ä–µ–Ω–∫–æ",
  email: "ivan@example.com",
  phone: "+380501234567",
  login: "ivan@example.com",
  password: "$2b$12$hashed_password_here", // –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ bcrypt –¥–ª—è —Ö–µ—à—É–≤–∞–Ω–Ω—è
  telegram_id: null,
  role: "admin",
  is_verified: true,
  language_code: "uk",
  created_at: new Date(),
  updated_at: new Date()
})
```

**–ê–¥–º—ñ–Ω —Ç—ñ–ª—å–∫–∏ –∑ Telegram:**

```javascript
db.admins.insertOne({
  first_name: "–ú–∞—Ä—ñ—è",
  last_name: "–ö–æ–≤–∞–ª—å",
  email: "maria@example.com",
  phone: "",
  login: "maria@example.com",
  password: null,  // –ë–µ–∑ –ø–∞—Ä–æ–ª—è
  telegram_id: 123456789,  // ID –∑ Telegram
  role: "agent",
  is_verified: true,
  language_code: "uk",
  created_at: new Date(),
  updated_at: new Date()
})
```

### –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ö–µ—à—É –ø–∞—Ä–æ–ª—è

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ Node.js:

```javascript
const bcrypt = require('bcrypt');
const password = 'your_password';
const hash = await bcrypt.hash(password, 12);
console.log(hash);
```

–ê–±–æ –æ–Ω–ª–∞–π–Ω: https://bcrypt-generator.com/ (rounds: 12)

---

## üîí –ë–µ–∑–ø–µ–∫–∞

### –©–æ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ localStorage

–ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –≤—Ö–æ–¥—É:

```javascript
localStorage.setItem('admin_authenticated', 'true');
localStorage.setItem('admin_token', 'base64_token');
localStorage.setItem('admin_info', JSON.stringify({
  id: "...",
  first_name: "...",
  last_name: "...",
  email: "...",
  role: "admin" | "agent",
  telegram_id: 123456789
}));
```

### –ó–∞—Ö–∏—Å—Ç –º–∞—Ä—à—Ä—É—Ç—ñ–≤

–í—Å—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:

```javascript
useEffect(() => {
  const isAuthenticated = localStorage.getItem('admin_authenticated');
  if (isAuthenticated !== 'true') {
    router.push('/admin');
  }
}, [router]);
```

---

## üÜï –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ä—ñ—î–ª—Ç–æ—Ä–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è

–ü—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—î:

```javascript
created_by: {
  admin_id: "6875195afbe9256561be9248",
  first_name: "–°–∞—à–∞",
  last_name: "–ß–∏–∂–∏–∫–æ–≤",
  email: "lilkakish@gmail.com",
  role: "admin"
}
```

### –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è

**–ù–∞ –¥–∞—à–±–æ—Ä–¥—ñ –∞–¥–º—ñ–Ω–∞:**
- –ü–æ–∫–∞–∑—É—î —Ö—Ç–æ –¥–æ–¥–∞–≤ –∫–æ–∂–µ–Ω –æ–±'—î–∫—Ç
- –í—ñ–¥–æ–±—Ä–∞–∂–∞—î —Ä–æ–ª—å (–ê–¥–º—ñ–Ω/–ê–≥–µ–Ω—Ç)
- –ü–æ–∫–∞–∑—É—î email

**–ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –Ω–µ—Ä—É—Ö–æ–º–æ—Å—Ç—ñ (–¥–ª—è –∫–ª—ñ—î–Ω—Ç—ñ–≤):**
- –í—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —è–∫ "–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π –∞–≥–µ–Ω—Ç"
- –ü–æ–∫–∞–∑—É—î –ø–æ–≤–Ω–µ —ñ–º'—è —Ä—ñ—î–ª—Ç–æ—Ä–∞

---

## ‚ùì –ß–∞—Å—Ç—ñ –ø–∏—Ç–∞–Ω–Ω—è

### –©–æ —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î —ñ –ø–∞—Ä–æ–ª—å, —ñ Telegram?

–ú–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π —Å–ø–æ—Å—ñ–± –≤—Ö–æ–¥—É.

### –©–æ —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–±—É–≤ –ø–∞—Ä–æ–ª—å?

1. –Ø–∫—â–æ —î Telegram - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –≤—Ö—ñ–¥ —á–µ—Ä–µ–∑ Telegram
2. –Ø–∫—â–æ –Ω–µ–º–∞—î Telegram - –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–≤–∏–Ω–µ–Ω –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π —Ö–µ—à –ø–∞—Ä–æ–ª—è —Ç–∞ –æ–Ω–æ–≤–∏—Ç–∏ –≤ –±–∞–∑—ñ

### –ß–∏ –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏ —Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞?

–¢–∞–∫, –æ–Ω–æ–≤—ñ—Ç—å –ø–æ–ª–µ `role` –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö:

```javascript
db.admins.updateOne(
  { email: "user@example.com" },
  { $set: { role: "admin" } }  // –∞–±–æ "agent"
)
```

### –Ø–∫ –≤–∏–¥–∞–ª–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞?

```javascript
db.admins.updateOne(
  { email: "user@example.com" },
  { $set: { is_verified: false } }
)
```

–ê–±–æ –≤–∏–¥–∞–ª–∏—Ç–∏ –ø–æ–≤–Ω—ñ—Å—Ç—é:

```javascript
db.admins.deleteOne({ email: "user@example.com" })
```

---

## üêõ –£—Å—É–Ω–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### –ü–æ–º–∏–ª–∫–∞: "Telegram –∞–∫–∞—É–Ω—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ"

**–ü—Ä–∏—á–∏–Ω–∞:** –£ –±–∞–∑—ñ –Ω–µ–º–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ —Ç–∞–∫–∏–º `telegram_id`

**–†—ñ—à–µ–Ω–Ω—è:** –î–æ–¥–∞–π—Ç–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ –±–∞–∑—É –∞–±–æ –æ–Ω–æ–≤—ñ—Ç—å `telegram_id`

### –ü–æ–º–∏–ª–∫–∞: "–î–ª—è —Ü—å–æ–≥–æ –∞–∫–∞—É–Ω—Ç–∞ –ø–∞—Ä–æ–ª—å –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ"

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è —É–≤—ñ–π—Ç–∏ —á–µ—Ä–µ–∑ –ª–æ–≥—ñ–Ω/–ø–∞—Ä–æ–ª—å, –∞–ª–µ `password` = `null`

**–†—ñ—à–µ–Ω–Ω—è:** –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –≤—Ö—ñ–¥ —á–µ—Ä–µ–∑ Telegram –∞–±–æ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø–∞—Ä–æ–ª—å –≤ –±–∞–∑—ñ

### Telegram Widget –Ω–µ –∑'—è–≤–ª—è—î—Ç—å—Å—è

**–ü—Ä–∏—á–∏–Ω–∏:**
1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π bot username
2. –î–æ–º–µ–Ω –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –≤ BotFather
3. –°–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–≤—Å—è

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ username –±–æ—Ç–∞ –≤ –∫–æ–¥—ñ
2. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –¥–æ–º–µ–Ω —á–µ—Ä–µ–∑ `/setdomain` –≤ BotFather
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –Ω–∞ –ø–æ–º–∏–ª–∫–∏

---

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–ü—Ä–∏ –≤–∏–Ω–∏–∫–Ω–µ–Ω–Ω—ñ –ø—Ä–æ–±–ª–µ–º:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ (—Ç–µ—Ä–º—ñ–Ω–∞–ª)
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–∏—Ö –≤ MongoDB
4. –ó–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º –æ–ø–∏—Å–æ–º –ø—Ä–æ–±–ª–µ–º–∏

---

**–í–µ—Ä—Å—ñ—è:** 1.0  
**–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:** –õ–∏—Å—Ç–æ–ø–∞–¥ 2025

